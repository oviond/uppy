{"version":3,"names":["h","PQueue","getSafeFileId","AuthView","Header","Browser","CloseWrapper","View","packageJson","formatBreadcrumbs","breadcrumbs","slice","map","directory","name","join","prependPath","path","component","defaultPickerIcon","focusable","width","height","viewBox","d","_abortController","_classPrivateFieldLooseKey","_withAbort","_list","_listFilesAndFolders","_recursivelyListAllFiles","ProviderView","constructor","plugin","opts","Object","defineProperty","value","_recursivelyListAllFiles2","_listFilesAndFolders2","_list2","_withAbort2","writable","defaultOptions","viewType","showTitles","showFilter","showBreadcrumbs","loadAllFiles","filterQuery","bind","clearFilter","getFolder","getNextFolder","logout","handleAuth","handleScroll","donePicking","render","setPluginState","authenticated","undefined","files","folders","filterInput","isSearchVisible","currentSelection","registerRequestClient","tearDown","requestPath","setLoading","_classPrivateFieldLooseBase","signal","lastCheckbox","getPluginState","index","findIndex","dir","nextPagePath","newFiles","newFolders","concat","uppy","i18n","numFiles","length","err","info","message","handleError","folder","res","provider","ok","revoked","title","url","manual_revoke_url","newState","input","authFormData","login","preFirstRender","log","event","shouldHandleScroll","isHandlingScroll","combinedFiles","combinedFolders","error","messages","selectedItem","withRelDirPath","newItem","relDirPath","absDirPath","replace","isFolder","isEmpty","numNewFiles","queue","concurrency","onFiles","newFile","tagFile","getTagFile","id","checkIfFileAlreadyExists","push","onIdle","smart_count","addFiles","file","requestClientId","forEach","clearSelection","state","viewOptions","_this","didFirstRender","targetViewOptions","loading","isChecked","toggleCheckbox","recordShiftKeyPress","filterItems","hasInput","pluginIcon","icon","headerProps","username","browserProps","showSearchFilter","search","clearSearch","searchTerm","searchOnInput","searchInputLabel","clearSearchLabel","noResultsLabel","done","cancel","cancelPicking","headerComponent","uppyFiles","getFiles","validateRestrictions","arguments","isLoading","onUnmount","pluginName","i18nArray","renderForm","renderAuthForm","op","_classPrivateFieldLoo","abort","abortController","AbortController","cancelRequest","on","off","_ref","items","list","item","_ref2","_ref3","curPath","filter","promises","add","Promise","all","VERSION","version"],"sources":["ProviderView.jsx"],"sourcesContent":["import { h } from 'preact'\nimport PQueue from 'p-queue'\n\nimport { getSafeFileId } from '@uppy/utils/lib/generateFileID'\n\nimport AuthView from './AuthView.jsx'\nimport Header from './Header.jsx'\nimport Browser from '../Browser.jsx'\nimport CloseWrapper from '../CloseWrapper.js'\nimport View from '../View.js'\n\nimport packageJson from '../../package.json'\n\nfunction formatBreadcrumbs (breadcrumbs) {\n  return breadcrumbs.slice(1).map((directory) => directory.name).join('/')\n}\n\nfunction prependPath (path, component) {\n  if (!path) return component\n  return `${path}/${component}`\n}\n\nexport function defaultPickerIcon () {\n  return (\n    <svg aria-hidden=\"true\" focusable=\"false\" width=\"30\" height=\"30\" viewBox=\"0 0 30 30\">\n      <path d=\"M15 30c8.284 0 15-6.716 15-15 0-8.284-6.716-15-15-15C6.716 0 0 6.716 0 15c0 8.284 6.716 15 15 15zm4.258-12.676v6.846h-8.426v-6.846H5.204l9.82-12.364 9.82 12.364H19.26z\" />\n    </svg>\n  )\n}\n\n/**\n * Class to easily generate generic views for Provider plugins\n */\nexport default class ProviderView extends View {\n  static VERSION = packageJson.version\n\n  /**\n   * @param {object} plugin instance of the plugin\n   * @param {object} opts\n   */\n  constructor (plugin, opts) {\n    super(plugin, opts)\n    // set default options\n    const defaultOptions = {\n      viewType: 'list',\n      showTitles: true,\n      showFilter: true,\n      showBreadcrumbs: true,\n      loadAllFiles: false,\n    }\n\n    // merge default options with the ones set by user\n    this.opts = { ...defaultOptions, ...opts }\n\n    // Logic\n    this.filterQuery = this.filterQuery.bind(this)\n    this.clearFilter = this.clearFilter.bind(this)\n    this.getFolder = this.getFolder.bind(this)\n    this.getNextFolder = this.getNextFolder.bind(this)\n    this.logout = this.logout.bind(this)\n    this.handleAuth = this.handleAuth.bind(this)\n    this.handleScroll = this.handleScroll.bind(this)\n    this.donePicking = this.donePicking.bind(this)\n\n    // Visual\n    this.render = this.render.bind(this)\n\n    // Set default state for the plugin\n    this.plugin.setPluginState({\n      authenticated: undefined, // we don't know yet\n      files: [],\n      folders: [],\n      breadcrumbs: [],\n      filterInput: '',\n      isSearchVisible: false,\n      currentSelection: [],\n    })\n\n    this.registerRequestClient()\n  }\n\n  // eslint-disable-next-line class-methods-use-this\n  tearDown () {\n    // Nothing.\n  }\n\n  #abortController\n\n  async #withAbort (op) {\n    // prevent multiple requests in parallel from causing race conditions\n    this.#abortController?.abort()\n    const abortController = new AbortController()\n    this.#abortController = abortController\n    const cancelRequest = () => {\n      abortController.abort()\n      this.clearSelection()\n    }\n    try {\n      this.plugin.uppy.on('dashboard:close-panel', cancelRequest)\n      this.plugin.uppy.on('cancel-all', cancelRequest)\n\n      await op(abortController.signal)\n    } finally {\n      this.plugin.uppy.off('dashboard:close-panel', cancelRequest)\n      this.plugin.uppy.off('cancel-all', cancelRequest)\n      this.#abortController = undefined\n    }\n  }\n\n  async #list ({ requestPath, absDirPath, signal }) {\n    const { username, nextPagePath, items } = await this.provider.list(requestPath, { signal })\n    this.username = username || this.username\n\n    return {\n      items: items.map((item) => ({\n        ...item,\n        absDirPath,\n      })),\n      nextPagePath,\n    }\n  }\n\n  async #listFilesAndFolders ({ breadcrumbs, signal }) {\n    const absDirPath = formatBreadcrumbs(breadcrumbs)\n\n    const { items, nextPagePath } = await this.#list({ requestPath: this.nextPagePath, absDirPath, signal })\n\n    this.nextPagePath = nextPagePath\n\n    const files = []\n    const folders = []\n\n    items.forEach((item) => {\n      if (item.isFolder) {\n        folders.push(item)\n      } else {\n        files.push(item)\n      }\n    })\n\n    return { files, folders }\n  }\n\n  /**\n   * Select a folder based on its id: fetches the folder and then updates state with its contents\n   * TODO rename to something better like selectFolder or navigateToFolder (breaking change?)\n   *\n   * @param  {string} requestPath\n   * the path we need to use when sending list request to companion (for some providers it's different from ID)\n   * @param  {string} name used in the UI and to build the absDirPath\n   * @returns {Promise}   Folders/files in folder\n   */\n  async getFolder (requestPath, name) {\n    this.setLoading(true)\n    try {\n      await this.#withAbort(async (signal) => {\n        this.lastCheckbox = undefined\n\n        let { breadcrumbs } = this.plugin.getPluginState()\n\n        const index = breadcrumbs.findIndex((dir) => requestPath === dir.requestPath)\n\n        if (index !== -1) {\n          // means we navigated back to a known directory (already in the stack), so cut the stack off there\n          breadcrumbs = breadcrumbs.slice(0, index + 1)\n        } else {\n          // we have navigated into a new (unknown) folder, add it to the stack\n          breadcrumbs = [...breadcrumbs, { requestPath, name }]\n        }\n\n        this.nextPagePath = requestPath\n        let files = []\n        let folders = []\n        do {\n          const { files: newFiles, folders: newFolders } = await this.#listFilesAndFolders({\n            breadcrumbs, signal,\n          })\n\n          files = files.concat(newFiles)\n          folders = folders.concat(newFolders)\n\n          this.setLoading(this.plugin.uppy.i18n('loadedXFiles', { numFiles: files.length + folders.length }))\n        } while (\n          this.opts.loadAllFiles && this.nextPagePath\n        )\n\n        this.plugin.setPluginState({ folders, files, breadcrumbs, filterInput: '' })\n      })\n    } catch (err) {\n      // This is the first call that happens when the provider view loads, after auth, so it's probably nice to show any\n      // error occurring here to the user.\n      if (err?.name === 'UserFacingApiError') {\n        this.plugin.uppy.info({ message: this.plugin.uppy.i18n(err.message) }, 'warning', 5000)\n        return\n      }\n\n      this.handleError(err)\n    } finally {\n      this.setLoading(false)\n    }\n  }\n\n  /**\n   * Fetches new folder\n   *\n   * @param  {object} folder\n   */\n  getNextFolder (folder) {\n    this.getFolder(folder.requestPath, folder.name)\n    this.lastCheckbox = undefined\n  }\n\n  /**\n   * Removes session token on client side.\n   */\n  async logout () {\n    try {\n      await this.#withAbort(async (signal) => {\n        const res = await this.provider.logout({ signal })\n        if (res.ok) {\n          if (!res.revoked) {\n            const message = this.plugin.uppy.i18n('companionUnauthorizeHint', {\n              provider: this.plugin.title,\n              url: res.manual_revoke_url,\n            })\n            this.plugin.uppy.info(message, 'info', 7000)\n          }\n\n          const newState = {\n            authenticated: false,\n            files: [],\n            folders: [],\n            breadcrumbs: [],\n            filterInput: '',\n          }\n          this.plugin.setPluginState(newState)\n        }\n      })\n    } catch (err) {\n      this.handleError(err)\n    }\n  }\n\n  filterQuery (input) {\n    this.plugin.setPluginState({ filterInput: input })\n  }\n\n  clearFilter () {\n    this.plugin.setPluginState({ filterInput: '' })\n  }\n\n  async handleAuth (authFormData) {\n    try {\n      await this.#withAbort(async (signal) => {\n        this.setLoading(true)\n        await this.provider.login({ authFormData, signal })\n        this.plugin.setPluginState({ authenticated: true })\n        this.preFirstRender()\n      })\n    } catch (err) {\n      if (err.name === 'UserFacingApiError') {\n        this.plugin.uppy.info({ message: this.plugin.uppy.i18n(err.message) }, 'warning', 5000)\n        return\n      }\n\n      this.plugin.uppy.log(`login failed: ${err.message}`)\n    } finally {\n      this.setLoading(false)\n    }\n  }\n\n  async handleScroll (event) {\n    if (this.shouldHandleScroll(event) && this.nextPagePath) {\n      this.isHandlingScroll = true\n\n      try {\n        await this.#withAbort(async (signal) => {\n          const { files, folders, breadcrumbs } = this.plugin.getPluginState()\n\n          const { files: newFiles, folders: newFolders } = await this.#listFilesAndFolders({\n            breadcrumbs, signal,\n          })\n\n          const combinedFiles = files.concat(newFiles)\n          const combinedFolders = folders.concat(newFolders)\n\n          this.plugin.setPluginState({ folders: combinedFolders, files: combinedFiles })\n        })\n      } catch (error) {\n        this.handleError(error)\n      } finally {\n        this.isHandlingScroll = false\n      }\n    }\n  }\n\n  async #recursivelyListAllFiles ({ requestPath, absDirPath, relDirPath, queue, onFiles, signal }) {\n    let curPath = requestPath\n\n    while (curPath) {\n      const res = await this.#list({ requestPath: curPath, absDirPath, signal })\n      curPath = res.nextPagePath\n\n      const files = res.items.filter((item) => !item.isFolder)\n      const folders = res.items.filter((item) => item.isFolder)\n\n      onFiles(files)\n\n      // recursively queue call to self for each folder\n      const promises = folders.map(async (folder) => queue.add(async () => (\n        this.#recursivelyListAllFiles({\n          requestPath: folder.requestPath,\n          absDirPath: prependPath(absDirPath, folder.name),\n          relDirPath: prependPath(relDirPath, folder.name),\n          queue,\n          onFiles,\n          signal,\n        })\n      )))\n      await Promise.all(promises) // in case we get an error\n    }\n  }\n\n  async donePicking () {\n    this.setLoading(true)\n    try {\n      await this.#withAbort(async (signal) => {\n        const { currentSelection } = this.plugin.getPluginState()\n\n        const messages = []\n        const newFiles = []\n\n        for (const selectedItem of currentSelection) {\n          const { requestPath } = selectedItem\n\n          const withRelDirPath = (newItem) => ({\n            ...newItem,\n            // calculate the file's path relative to the user's selected item's path\n            // see https://github.com/transloadit/uppy/pull/4537#issuecomment-1614236655\n            relDirPath: newItem.absDirPath.replace(selectedItem.absDirPath, '').replace(/^\\//, ''),\n          })\n\n          if (selectedItem.isFolder) {\n            let isEmpty = true\n            let numNewFiles = 0\n\n            const queue = new PQueue({ concurrency: 6 })\n\n            const onFiles = (files) => {\n              for (const newFile of files) {\n                const tagFile = this.getTagFile(newFile)\n                const id = getSafeFileId(tagFile)\n                // If the same folder is added again, we don't want to send\n                // X amount of duplicate file notifications, we want to say\n                // the folder was already added. This checks if all files are duplicate,\n                // if that's the case, we don't add the files.\n                if (!this.plugin.uppy.checkIfFileAlreadyExists(id)) {\n                  newFiles.push(withRelDirPath(newFile))\n                  numNewFiles++\n                  this.setLoading(this.plugin.uppy.i18n('addedNumFiles', { numFiles: numNewFiles }))\n                }\n                isEmpty = false\n              }\n            }\n\n            await this.#recursivelyListAllFiles({\n              requestPath,\n              absDirPath: prependPath(selectedItem.absDirPath, selectedItem.name),\n              relDirPath: selectedItem.name,\n              queue,\n              onFiles,\n              signal,\n            })\n            await queue.onIdle()\n\n            let message\n            if (isEmpty) {\n              message = this.plugin.uppy.i18n('emptyFolderAdded')\n            } else if (numNewFiles === 0) {\n              message = this.plugin.uppy.i18n('folderAlreadyAdded', {\n                folder: selectedItem.name,\n              })\n            } else {\n              // TODO we don't really know at this point whether any files were actually added\n              // (only later after addFiles has been called) so we should probably rewrite this.\n              // Example: If all files fail to add due to restriction error, it will still say \"Added 100 files from folder\"\n              message = this.plugin.uppy.i18n('folderAdded', {\n                smart_count: numNewFiles, folder: selectedItem.name,\n              })\n            }\n\n            messages.push(message)\n          } else {\n            newFiles.push(withRelDirPath(selectedItem))\n          }\n        }\n\n        // Note: this.plugin.uppy.addFiles must be only run once we are done fetching all files,\n        // because it will cause the loading screen to disappear,\n        // and that will allow the user to start the upload, so we need to make sure we have\n        // finished all async operations before we add any file\n        // see https://github.com/transloadit/uppy/pull/4384\n        this.plugin.uppy.log('Adding files from a remote provider')\n        this.plugin.uppy.addFiles(newFiles.map((file) => this.getTagFile(file, this.requestClientId)))\n\n        this.plugin.setPluginState({ filterInput: '' })\n        messages.forEach(message => this.plugin.uppy.info(message))\n\n        this.clearSelection()\n      })\n    } catch (err) {\n      this.handleError(err)\n    } finally {\n      this.setLoading(false)\n    }\n  }\n\n  render (state, viewOptions = {}) {\n    const { authenticated, didFirstRender } = this.plugin.getPluginState()\n    const { i18n } = this.plugin.uppy\n\n    if (!didFirstRender) {\n      this.preFirstRender()\n    }\n\n    const targetViewOptions = { ...this.opts, ...viewOptions }\n    const { files, folders, filterInput, loading, currentSelection } = this.plugin.getPluginState()\n    const { isChecked, toggleCheckbox, recordShiftKeyPress, filterItems } = this\n    const hasInput = filterInput !== ''\n    const pluginIcon = this.plugin.icon || defaultPickerIcon\n\n    const headerProps = {\n      showBreadcrumbs: targetViewOptions.showBreadcrumbs,\n      getFolder: this.getFolder,\n      breadcrumbs: this.plugin.getPluginState().breadcrumbs,\n      pluginIcon,\n      title: this.plugin.title,\n      logout: this.logout,\n      username: this.username,\n      i18n,\n    }\n\n    const browserProps = {\n      isChecked,\n      toggleCheckbox,\n      recordShiftKeyPress,\n      currentSelection,\n      files: hasInput ? filterItems(files) : files,\n      folders: hasInput ? filterItems(folders) : folders,\n      getNextFolder: this.getNextFolder,\n      getFolder: this.getFolder,\n      loadAllFiles: this.opts.loadAllFiles,\n\n      // For SearchFilterInput component\n      showSearchFilter: targetViewOptions.showFilter,\n      search: this.filterQuery,\n      clearSearch: this.clearFilter,\n      searchTerm: filterInput,\n      searchOnInput: true,\n      searchInputLabel: i18n('filter'),\n      clearSearchLabel: i18n('resetFilter'),\n\n      noResultsLabel: i18n('noFilesFound'),\n      logout: this.logout,\n      handleScroll: this.handleScroll,\n      done: this.donePicking,\n      cancel: this.cancelPicking,\n      headerComponent: Header(headerProps),\n      title: this.plugin.title,\n      viewType: targetViewOptions.viewType,\n      showTitles: targetViewOptions.showTitles,\n      showBreadcrumbs: targetViewOptions.showBreadcrumbs,\n      pluginIcon,\n      i18n: this.plugin.uppy.i18n,\n      uppyFiles: this.plugin.uppy.getFiles(),\n      validateRestrictions: (...args) => this.plugin.uppy.validateRestrictions(...args),\n      isLoading: loading,\n    }\n\n    if (authenticated === false) {\n      return (\n        <CloseWrapper onUnmount={this.clearSelection}>\n          <AuthView\n            pluginName={this.plugin.title}\n            pluginIcon={pluginIcon}\n            handleAuth={this.handleAuth}\n            i18n={this.plugin.uppy.i18nArray}\n            renderForm={this.opts.renderAuthForm}\n            loading={loading}\n          />\n        </CloseWrapper>\n      )\n    }\n\n    return (\n      <CloseWrapper onUnmount={this.clearSelection}>\n        {/* eslint-disable-next-line react/jsx-props-no-spreading */}\n        <Browser {...browserProps} />\n      </CloseWrapper>\n    )\n  }\n}\n"],"mappings":"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"}